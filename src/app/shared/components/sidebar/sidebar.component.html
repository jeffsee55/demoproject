<div class="sidebar-main-section">
  <mat-toolbar class="nav-toolbar">
    <mat-toolbar-row class="justify-content-between p-0">
      <mat-icon class="logo-content" svgIcon="logo_name"></mat-icon>
      <button
        fxHide
        fxShow.gt-md
        mat-icon-button
        (click)="sidenav?.toggle()"
        class="nav-toggle-btn"
      >
        <mat-icon style="color: #f77e08">menu</mat-icon>
      </button>
      <button
        class="close"
        fxHide.gt-md
        fxShow
        mat-icon-button
        (click)="sidenav?.toggle()"
      >
        <mat-icon color="black">close</mat-icon>
      </button>
    </mat-toolbar-row>
  </mat-toolbar>
  <mat-divider color="accent" class="my-2"></mat-divider>

  <mat-nav-list class="nav-bar-list">
    <div fxHide.gt-md fxLayout="row" class="justify-content-between gap-1">
      <button mat-stroked-button color="accent" class="premium-btn-mr">
        <mat-icon
          style="
            height: 24px;
            width: 24px;
            line-height: 20px;
            margin-right: 5px;
          "
          svgIcon="premium"
        ></mat-icon>
        Premium Plan
      </button>

      <button mat-flat-button color="accent" class="icon-btn-mr">
        <mat-icon
          style="height: 24px; width: 24px; line-height: 20px; margin: 0"
          svgIcon="notifications"
        >
        </mat-icon>
      </button>

      <button mat-flat-button color="primary" class="icon-btn-mr">
        <mat-icon
          style="height: 24px; width: 24px; line-height: 20px; margin: 0"
          svgIcon="settings"
        ></mat-icon>
      </button>

      <button mat-flat-button color="warn" class="icon-btn-mr" (click)="logout()">
        <mat-icon
          style="height: 24px; width: 24px; line-height: 20px; margin: 0"
          svgIcon="logout"
        ></mat-icon>
      </button>
    </div>
    <mat-divider fxHide.gt-md color="accent" class="my-2"></mat-divider>

    <div fxHide.gt-md fxLayout="column" class="gap-1">
      <mat-form-field
        style="margin-bottom: 10px !important"
        appearance="outline"
        subscriptSizing="dynamic"
        class="downIcon"
      >
        <mat-select
          placeholder="Please Select"
          disableOptionCentering
          class="company-dropdown common-font-14px"
          (selectionChange)="onDropdownChange($event)" 
          [(ngModel)]="selectedCompany"
        >
          <mat-option *ngFor="let profile of profileList" [value]="profile.CompanyName">{{profile.CompanyName}}</mat-option>
        </mat-select>
      </mat-form-field>

      <button
        mat-flat-button
        color="accent"
        style="color: white; font-size: 14px !important"
        class="premium-btn-mr"
      >
        <mat-icon style="line-height: 0px" svgIcon="add_icon"></mat-icon> New
        Company Profile
      </button>
    </div>
    <mat-divider fxHide.gt-md color="accent" class="my-2"></mat-divider>
    <ng-container *ngFor="let menu of menuList; index as i">
      <ng-container
        [ngTemplateOutlet]="menu.subMenu ? childMenu : parentMenu"
        [ngTemplateOutletContext]="{ menu: menu }"
      >
      </ng-container>
    </ng-container>

    <button
      fxHide
      fxShow.gt-md
      mat-stroked-button
      style="width: 100%; border-color: #faa81a"
      color="accent"
      *ngIf="premiumPlanVisible"
      (click)="openPermissionDialog()"
    >
      <mat-icon
        style="height: 24px; width: 24px; line-height: 20px; margin-right: 5px"
        svgIcon="premium"
      ></mat-icon>
      <span>{{ planName }}</span>
    </button>
    <ng-template #parentMenu let-menu="menu">
      <a
        class="main-menu"
        mat-list-item
        [routerLink]="menu.route"
        [activated]="currentRoute.parent === menu.route"
        (click)="toggleActiveRoute(menu.route, '', false, menu.name)"
      >
        <mat-icon
          color="#000"
          [svgIcon]="
            currentRoute.parent === menu.route ? menu.activeIcon : menu.icon
          "
        ></mat-icon
        ><span>{{ menu.name }}</span>
      </a>
    </ng-template>
    <div class="responsiveititme-bottom-last-height"></div>

    <ng-template #childMenu let-menu="menu">
      <mat-expansion-panel [class.mat-elevation-z0]="true">
        <mat-expansion-panel-header
          [ngClass]="currentRoute.parent === menu.route ? 'activate' : ''"
          (click)="toggleActiveRoute(menu.route, '', true)"
        >
          <mat-icon
            [svgIcon]="
              currentRoute.parent === menu.route ? menu.activeIcon : menu.icon
            "
          ></mat-icon>
          {{ menu.name }}
        </mat-expansion-panel-header>
        <mat-nav-list>
          <a
            mat-list-item
            class="sub-menu"
            [routerLink]="submenu.route"
            [activated]="currentRoute.child === menu.route"
            *ngFor="let submenu of menu.subMenu; let i = index"
            routerLinkActive="is-active"
            [routerLinkActiveOptions]="{ exact: true }"
            (click)="toggleActiveRoute(menu.route, submenu.route, false)"
          >
            <mat-icon style="font-size: 8px; line-height: unset"
              >circle_filled</mat-icon
            >
            {{ submenu.name }}
          </a>
        </mat-nav-list>
      </mat-expansion-panel>
    </ng-template>
  </mat-nav-list>
</div>
