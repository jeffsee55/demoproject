<mat-card-actions
  fxLayout="row "
  fxLayoutAlign="space-between baseline"
  fxLayout.sm="column"
  fxLayout.xs="column"
  style="margin-bottom: 16px"
>
  <div
    fxLayout.xs="row"
    fxLayout.sm="row"
    fxAlign.xs="start"
    style="width: max-content"
  >
    <nav class="header-breadcrumb" aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item first-item">
          <a href="#" class="common-main-title-font">Reports</a>
        </li>
        <li class="breadcrumb-item actives" aria-current="page">QR Report</li>
      </ol>
    </nav>
  </div>
  <div class="from-to-date">
    <div class="from-to-date-component">
      <label class="me-2">From:</label>
      <mat-form-field appearance="outline" class="form-element input-full-width">
        <input matInput placeholder="mm-dd-yyyy" [matDatepicker]="fromDatePicker" [(ngModel)]="fromDate" (dateChange)="dateChanged($event)" />
        <mat-datepicker-toggle matSuffix [for]="fromDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #fromDatePicker></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="from-to-date-component">
      <label class="me-2">To:</label>
      <mat-form-field appearance="outline" class="form-element input-full-width">
        <input matInput placeholder="mm-dd-yyyy" [matDatepicker]="toDatePicker" [(ngModel)]="toDate" (dateChange)="dateChanged($event)" />
        <mat-datepicker-toggle matSuffix [for]="toDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #toDatePicker></mat-datepicker>
      </mat-form-field>
    </div>
  </div>
</mat-card-actions>

<div class="card mb-3" *ngIf="!hasDepartmentWiseQRData()">
  <div class="qr-code">
    Department Wise QR
  </div>
  <div class="message">
    No data available
  </div>
</div>
<div class="report-page qr-report">
  <div class="leaderboards" [ngClass]="hasDepartmentWiseQRData() ? 'd-block' : 'd-none'">
    <div class="all-pr-sec">
      <mat-card-actions class="review-rating-card-header-section">
        <section class="mat-typography w-100 d-flex justify-content-between">
          <h1>Leaderboard</h1>
          <div class="chart-labels d-none d-lg-flex">
            <div class="label-circle-container">
              <div class="label-circle" style="background-color: #22c55e"></div>
              <label class="common-label-font">QR Arrived</label>
            </div>
            <div class="label-circle-container">
              <div class="label-circle common-primary-bg"></div>
              <label class="common-label-font">Redirect To Review</label>
            </div>
            <div class="label-circle-container">
              <div class="label-circle" style="background-color: #faa81a"></div>
              <label class="common-label-font">Negative Feedback</label>
            </div>
          </div>
        </section>
      </mat-card-actions>
      <hr class="hr-tag" />
        <div class="chart-container stacked-bar">
          <canvas id="leaderboard">{{ leaderboardchart }}</canvas>
        </div>
      <div class="chart-labels d-lg-none">
        <div class="label-circle-container">
          <div class="label-circle" style="background-color: #22c55e"></div>
          <label class="common-label-font">QR Arrived</label>
        </div>
        <div class="label-circle-container">
          <div class="label-circle common-primary-bg"></div>
          <label class="common-label-font">Redirect To Review</label>
        </div>
        <div class="label-circle-container">
          <div class="label-circle" style="background-color: #faa81a"></div>
          <label class="common-label-font">Negative Feedback</label>
        </div>
      </div>
    </div>
  </div>

  <div class="all-pr-sec department-leaderboard">
    <div class="d-flex justify-content-between">
      <mat-card-actions class="review-rating-card-header-section">
        <section class="mat-typography w-100 d-flex justify-content-between">
          <h1>Employee Leaderboard</h1>
        </section>
      </mat-card-actions>
      <hr class="hr-tag" />
      <div class="department-leaderboard-section">
        <div class="qr-report-green-button">
          <button mat-flat-button class="green-button text-white" [disabled]="!dataSource1 || dataSource1?.length === 0" (click)="exportLeaderboardData('Employee')">
            <mat-icon
              matPrefix
              [svgIcon]="'download_icon'"
              style="width: 25px; height: 30px"
            ></mat-icon>
            Download Report
          </button>
        </div>
      </div>
    </div>
    <div class="qr-table-container">
      <table mat-table [dataSource]="dataSource1" class="mat-elevation-z8">
        <ng-container matColumnDef="employeeName">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="text-align-start-force"
          >
          Employee
          </th>
          <td
            mat-cell
            *matCellDef="let element"
            class="text-align-start-force ps-3"
          >
            {{ element?.employeeName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="qrArrived">
          <th
            mat-header-cell
            *matHeaderCellDef
            class="text-align-start-force"
          >
            QR Arrived
          </th>
          <td
            mat-cell
            *matCellDef="let element"
            class="text-align-start-force px-3"
          >
            <div>{{ element?.qrArrived }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="redirectToReview">
          <th mat-header-cell *matHeaderCellDef class="text-center">
            Redirect To Review
          </th>
          <td mat-cell *matCellDef="let element" class="text-center">
            {{ element?.redirectToReview }}
          </td>
        </ng-container>

        <ng-container matColumnDef="privatefeedback">
          <th mat-header-cell *matHeaderCellDef class="text-center">
            Negative Feedback
          </th>
          <td mat-cell *matCellDef="let element" class="text-center">
            {{ element?.privatefeedback }}
          </td>
        </ng-container>

        <ng-container matColumnDef="noData">
          <mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns1.length">
            Employee Leaderboard not found.
          </mat-footer-cell>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns1"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns1"></tr>
        <mat-footer-row *matFooterRowDef="['noData']" [hidden]="dataSource1 && dataSource1.length > 0"></mat-footer-row>
      </table>
    </div>
    <app-paginator [pager]="employeeLeaderboardPager" (setPage)="employeeLeaderboardSetPage($event)" (setItems)="employeeSetItemsSorting($event)"></app-paginator>
  </div>

  <div class="all-pr-sec department-leaderboard">
    <div class="d-flex justify-content-between">
      <mat-card-actions class="review-rating-card-header-section">
        <section class="mat-typography w-100 d-flex justify-content-between">
          <h1>Department Leaderboard</h1>
        </section>
      </mat-card-actions>
      <hr class="hr-tag" />
      <div class="department-leaderboard-section">
        <div class="qr-report-green-button">
          <button mat-flat-button class="green-button text-white" [disabled]="!dataSource2 || dataSource2?.length === 0" (click)="exportLeaderboardData('Department')">
            <mat-icon
              matPrefix
              [svgIcon]="'download_icon'"
              style="width: 25px; height: 30px"
            ></mat-icon>
            Download Report
          </button>
        </div>
      </div>
    </div>
    <div class="qr-table-container">
      <table mat-table [dataSource]="dataSource2" class="mat-elevation-z8">
        <ng-container matColumnDef="departmentName">
          <th mat-header-cell *matHeaderCellDef class="text-align-start-force">
            Department
          </th>
          <td
            mat-cell
            *matCellDef="let element"
            class="text-align-start-force ps-3"
          >
            {{ element?.departmentName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="qrArrived">
          <th mat-header-cell *matHeaderCellDef class="text-align-start-force">
            QR Arrived
          </th>
          <td
            mat-cell
            *matCellDef="let element"
            class="text-align-start-force px-3"
          >
            <div class="td-with-icon">
              <div>{{ element?.qrArrived }}</div>
              <mat-card-title [ngClass]="(+element?.qrArrived) > (+element?.prevQrArrived) ? 'positive' : 'negative'">
                <span class="d-flex justify-content align-items-center" *ngIf="(+element?.qrArrived) != (+element?.prevQrArrived)">
                  <p style="margin: 0px" [ngClass]="(+element?.qrArrived) > (+element?.prevQrArrived) ? 'positive' : 'negative'"> {{
                    (+element?.qrArrived) - (+element?.prevQrArrived) }}</p>
                  &nbsp;<mat-icon style="height: 29px; width: 24px"
                    [svgIcon]="(+element?.qrArrived) > (+element?.prevQrArrived) ? 'going_up' : 'tavor'"></mat-icon>
                </span>
              </mat-card-title>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="redirectToReview">
          <th mat-header-cell *matHeaderCellDef class="text-center">
            Redirect To Review
          </th>
          <td mat-cell *matCellDef="let element" class="text-center">
            {{ element?.redirectToReview }}
          </td>
        </ng-container>

        <ng-container matColumnDef="positivefeedback">
          <th mat-header-cell *matHeaderCellDef class="text-center">
            Positive Feedback
          </th>
          <td
            mat-cell
            *matCellDef="let element"
            class="text-align-center-force px-3"
          >
            <div class="td-with-icon justify-content-center">
              <div>{{ element?.positivefeedback }}</div>
              <mat-card-title [ngClass]="(+element?.positivefeedback) > (+element?.prevpositivefeedback) ? 'positive' : 'negative'">
                <span class="d-flex justify-content align-items-center"
                  *ngIf="(+element?.positivefeedback) != (+element?.prevpositivefeedback)">
                  <p style="margin: 0px"
                    [ngClass]="(+element?.positivefeedback) > (+element?.prevpositivefeedback) ? 'positive' : 'negative'"> {{
                    (+element?.positivefeedback) - (+element?.prevpositivefeedback) }}</p>
                  &nbsp;<mat-icon style="height: 29px; width: 24px"
                    [svgIcon]="(+element?.positivefeedback) > (+element?.prevpositivefeedback) ? 'going_up' : 'tavor'"></mat-icon>
                </span>
              </mat-card-title>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="privatefeedback">
          <th mat-header-cell *matHeaderCellDef class="text-center">
            Negative Feedback
          </th>
          <td mat-cell *matCellDef="let element" class="text-center">
            {{ element?.privatefeedback }}
          </td>
        </ng-container>

        <ng-container matColumnDef="noData">
          <mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumns2.length">
            Department Leaderboard not found.
          </mat-footer-cell>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns2"></tr>
        <mat-footer-row *matFooterRowDef="['noData']" [hidden]="dataSource2 && dataSource2.length > 0"></mat-footer-row>
      </table>
    </div>
    <app-paginator [pager]="departmentLeaderboardPager" (setPage)="departmentLeaderboardSetPage($event)" (setItems)="departmentSetItemsSorting($event)"></app-paginator>
  </div>
</div>
